\newpage
\section{Theoretical background}\label{theory}

\subsection{Variational problem}
We recall the strong formulation of the general problem: on a polygonal domain $\Omega \subset \R^n$, find a solution $u$ of 
\begin{equation}\label{strong}
-\Delta u = f \text{ in } \Omega, \text{ and } u = g \text{ on } \Gamma = \partial \Omega,
\end{equation}
where $f$ and $g$ are given functions defined respectively in $\Omega$ and on $\Gamma$. 

Suppose that $f\in L^2(\Omega)$ and $g\in H^{1/2}(\Gamma)$. We multiply equation (\ref{strong}) by an arbitrary function $v$, and we integrate the strong form. Thanks to Green formula, we obtain:
\begin{equation}\label{varform} \int_\Omega \nabla u\cdot \nabla v \, \mathrm{d}\Omega- \int_\Gamma (\nabla u \cdot \vec{n}) v \, \mathrm{d}\Gamma = \int_\Omega fv \, \mathrm{d}\Omega, 
\end{equation}
where $\vec{n}$ is the exterior normal vector to the surface boundary $\Gamma$. Suppose there exist a continuous lifting of the boundary data $R_g \in H^1(\Omega)$ such that  $R_g|_{\Gamma} = g$. We set $\tilde{u} = u - R_g$, so that $\tilde{u}|_\Gamma = u|_\Gamma - R_g|\Gamma = g-g = 0$, and $\nabla \tilde{u} = \nabla \tilde{u} - \nabla \tilde{R_g}$. Consequently, equation (\ref{varform}) becomes: 
\begin{equation*}
\int_\Omega \nabla \tilde{u}\cdot \nabla v \, \mathrm{d}\Omega = \int_\Omega fv \, \mathrm{d}\Omega -	 \int_\Omega \nabla R_g \cdot \nabla v \, \mathrm{d}\Omega.
\end{equation*}
In the following, we omit the tilde on $\tilde{u}$ for a matter of simplicity. The variational formulation of our problem is thus now the following: find $u$ in $V=H^1_0(\Omega)$ such that for all $v\in V$, 
\begin{equation}\label{weak}
a(u,v) = F(v),
\end{equation}
where $a : V \times V \rightarrow \R$ is such that $a(w,v) = \int_\Omega \nabla w\cdot \nabla v \, \mathrm{d}\Omega$ for all $w,v\in V$, and $F:V\rightarrow\R$ is such that for all $v\in V$, $F(v) = -a(R_g, v) + \int_\Omega fv \, \mathrm{d}\Omega$.

We choose the semi-norm of $H^1(\Omega)$ to be the norm we will use for functions in $H^1_0(\Omega) = V$, thanks to Poincar√© inequality. In $V$ equipped to this norm, it is easy to show that $a$ is a continuous and coercive bilinear form, and that $F$ is a linear and continuous functional. We just prove here some of the main properties: for all $w,v\in V$, 
\begin{align*}
F(v) &= \int_\Omega fv \, \mathrm{d}\Omega -\int_\Omega \nabla R_g \cdot \nabla v \, \mathrm{d} \Omega \\
& \leq \int_\Omega fv \, \mathrm{d}\Omega \text{\textbf{ TODO NOOOOOOOOOOOOOOO!!}}\\
& \leq \|f\|_{L^2(\Omega)}\|v\|_{L^2(\Omega)}\\
& \leq \|f\|_{L^2(\Omega)}\|v\|_{H_0^1(\Omega)};
\end{align*}
\begin{align}
a(v,v) &= \int_\Omega \nabla v \cdot \nabla v \, \mathrm{d} \Omega = \|v\|^2_{H_0^1(\Omega)} \nonumber \\
& \geq 1\cdot \|v\|^2_{H_0^1(\Omega)}; \label{acoercive}\\
a(w,v) &= \int_\Omega \nabla w \cdot \nabla v \, \mathrm{d} \Omega \nonumber \\
& \leq 1 \cdot \|w\|_{H_0^1(\Omega)}\|v\|_{H_0^1(\Omega)}.\nonumber
\end{align} 
Cauchy-Schwarz inequality has been used to show both continuities. Thus by Lax-Milgram theorem, there exists a unique solution to the weak problem expressed in equation (\ref{weak}). 


\subsection{Discrete problem}

\subsubsection{Domain decomposition}
Consider a sequence of decompositions $\{T_h\}_h$ of $\Omega$, where $h$ corresponds to the maximum of the diameters $h_K$ of the elements $K$ of the decomposition $T_h$. Let us recall the definition of the diameter of an element: 

\begin{definition}[Diameter]
The \textit{diameter} of an element $K$ of a domain decomposition is defined as $h_K = \max_{x,y\in K}|x-y|$. 
\end{definition}

\noindent Since we only consider polygonal domains $\Omega$, then exact decompositions with simple polygons exist. 

\begin{definition}[Simple polygon]
A \textit{simple polygon} is an open simply connected set whose boundary is a non-intersecting line made of a finite number of straight line segments. 
\end{definition}

\noindent From now on, we suppose that every considered decomposition $T_h$ is made of a finite number of simple polygons. Note that a simple polygon is not necessarily convex, and this is what is the first difference that characterizes VEM with respect to FEM. We now introduce the following notation: 
\begin{notation}
For any set of functions $W$, we note $W|_K$ the set of functions in $W$ restricted to $K$, that is $W|_K = \{f|_K : f\in W\}$. 
\end{notation}

\noindent Let us define the bilinear form $a$ reduced to any element $K$ of a decomposition $T_h$ of $\Omega$ as follows: for all $w,v\in V$,
$$ a^K(w,v) := \int_K \nabla w \cdot \nabla v \, \mathrm{d}\Omega. $$
Since the restriction of any function of $H_0^1(\Omega)$ on a sub-domain $K$ of $\Omega$ is still in $H_0^1(\Omega)$ but not necessarily in $H_0^1(K)$, we note that $a^K$ is also a continuous bilinear form on $V\times V$, but it is not necessarily coercive. Moreover, for all $h$ and for all $w,v\in V$, \begin{equation}\label{aKvsa}
a(w,v) = \sum_{K\in T_h} a^K(w,v).
\end{equation}
In the same way, since $H_0^1(\Omega)|_K = V|_K \subset H^1(K)$, we define for all $v\in V$
\begin{align}
&|v|_{1, K} := |(v|_K)|_{H^1(K)} = \left( a^K\left( v,v \right)\right)^{1/2}, \label{def1Knorm}\\
&\text{so that } \|v\|_{H_0^1(\Omega)} = \left(\sum_{K\in T_h} |v|_{1,K}^2\right)^{1/2}.\label{H01normsplit}
\end{align} 

\noindent Furthermore, for every $h$, we will denote $E_h$ the set of edges of the decomposition $T_h$. 

\subsubsection{Space discretization}
For every domain decomposition $T_h$, the aim of VEM is to come up with a finite subspace $V_h$ of $V$ such that:
\begin{itemize}
\item we can obtain a discretized version of problem (\ref{weak}),
\item the discretized problem has a unique solution,
\item the unique solution of the discretized problem has good approximation properties with respect to the exact solution. 
\end{itemize}

\noindent To do so, we first need to introduce a notation, and a broken $H^1$-semi-norm to deal with functions of $H^1(T_h) := \Pi_{K\in T_h}H^1(K)$, for all $h$. 
\begin{notation}
For every domain $D$ and every non-negative integer $k$, $\mathbb{P}_k(D)$ is the set of polynomials in $D$ of degree at most $k$, and $\mathbb{P}_{-1}(D)=\{0\}$.
\end{notation}
\begin{definition}[Broken semi-norm on $H^1(T_h)$]
For all $v\in H^1(T_h)$, we define:
$$ |v|_{h,1} := \left( \sum_{K\in T_h} |\nabla v|^2_{L^2(K)} \right)^{\frac{1}{2}}.$$
\end{definition}

\noindent To figure out what we exactly need to build, we state and prove the following theorem: 

\begin{theorem}
For each $h$, suppose that
\begin{enumerate}
\item on one hand, we have \begin{enumerate}
\item a suitable finite dimensional subspace $V_h$ of $V$;
\item a symmetric bilinear form $a_h : V_h\times V_h \rightarrow \R$, and for all $K$ in $T_h$ a bilinear form $a_h^K:V_h|_K \times V_h|_K \rightarrow \R$, such that for all $w_h,v_h\in V_h$, 
$$ a_h(w_h, v_h) = \sum_{K\in T_h} a_h^K(w_h|_K,v_h|_K).$$ For simplicity, we write $a_h^K(w_h,v_h)$ instead of $a_h^K(w_h|_K,v_h|_K)$;
\item an element $f_h \in V_h'$ where $V_h'$ is the dual of $V_h$;
\end{enumerate}
\item on the other hand, there exists an integer $k\geq 1$ such that for all $K \in T_h$,
\begin{enumerate}
\item $\mathbb{P}_k(K) \subset V_h|_K$, that is our virtual space restricted to any element of the domain decomposition contains the set of polynomials of order at most $k$;
\item(k-consistency) for all $p\in \mathbb{P}_k(K)$, for all $v_h\in V_h|_K$, the relation $a_h^K(p, v_h) = a^K(p, v_h)$ is verified;
\item (stability) there exist $\alpha^-, \alpha^+ \geq 0$ two constants independent of $h$ and of $K$ such that for all $v_h\in V_h|_K$,
$$ \alpha^-a^K(v_h,v_h)\leq a_h^K(v_h,v_h)\leq \alpha^+a^K(v_h,v_h).$$
\end{enumerate}
\end{enumerate}
Under these hypothesis, 
\begin{enumerate}
\item the following discrete problem: find $u_h\in V_h$ such that for all $v_h \in V_h$, \begin{equation}\label{discretepb}
a_h(u_h,v_h) = \langle f_h,v_h\rangle,
\end{equation} admits a unique solution;
\item for every approximations $u_I\in V_h$ and $u_\pi$ that is piecewise in $\mathbb{P}_k$, of the exact solution $u$ of problem (\ref{weak}), $$|u-u_h|_{L^1(\Omega)} \leq C\left(|u-u_I|_{L^1(\Omega)} + |u-u_\pi|_{h,1} + \mathcal{F}_h\right),$$
where $C=C(\alpha^-,\alpha^-)$, and $\mathcal{F}_h$ is the smallest constant such that for all $v\in V_h$, $$F(v)-\langle f_h,v\rangle \leq \mathcal{F}_h\|v\|_{H^0_1(\Omega)}.$$ 
\end{enumerate}
\end{theorem}
\begin{notation}
Note that here, for $f_h\in V_h'$ and $v_h \in V_h$, $\langle f_h,v_h\rangle$ designs the action of $f_h$ on $v_h$.
\end{notation}

\noindent Let us prove this theorem:
\begin{proof}
We will prove the two conclusions in order. The abbreviation CS is used to say that we use the Cauchy-Schwarz inequality.
\begin{enumerate}
\item We want to use Lax-Milgram theorem. 
\begin{itemize}
\item Since $V_h$ is a finite dimensional subspace of the Hilbert space $V$, then it is a closed subspace of an Hilbert space, so that $V_h$ is also an Hilbert space. We still consider the $H^1(\Omega)$-semi-norm as the $H_0^1(\Omega)$-norm, i.e. the $V$-norm, and thus as the $V_h$-norm as well.
\item By hypothesis $1.b$ and $1.c$, $a_h$ is a bilinear form and $f_h$ is a linear and continuous functional.
\item Continuity of $a_h$: first, for all $w,v\in V_h|_K$, 
\begin{align}
a_h^K(w,v) &\leq \left( a_h^K\left( w,w \right)\right)^{1/2}\left( a_h^K\left (v,v \right)\right)^{1/2} &\text{ (CS)} \nonumber \\
&\leq \alpha^+\left( a^K\left( w,w \right)\right)^{1/2}\left( a^K\left (v,v \right)\right)^{1/2} &\text{ (stability)} \nonumber \\
&= \alpha^+|u|_{1,K}|v|_{1,K}. &\text{ (definition)} \label{ahKalpha}
\end{align}
Consequently, for all $w_h, v_h \in V_h$, 
\begin{align*}
a_h(w_h,v_h) &= \sum_{K\in T_h} a_h^K(w_h,v_h) &\text{ (hypothesis }1.b)\\
&\leq \alpha^+\sum_{K\in T_h} |w_h|_{1,K}|v_h|_{1,K} &\text{ (inequality \ref{ahKalpha})}\\
&\leq \alpha^+\left( \sum_{K\in T_h}|w_h|_{1,K}^2 \right)^{1/2}\left( \sum_{K\in T_h}|v_h|_{1,K}^2 \right)^{1/2} &\text{ (discrete CS)}\\
&= \alpha^+ \|w_h\|_{H_0^1(\Omega)}\|v_h\|_{H_0^1(\Omega)}. &\text{ (equation \ref{H01normsplit})}
\end{align*}
\item Coercivity of $a_h$: for all $v_h\in V_h$, 
\begin{align*}
a_h(v_h,v_h) &= \sum_{K\in T_h} a_h^K(v_h,v_h) &\text{ (hypothesis }1.b)\\
&\geq \alpha^-\sum_{K\in T_h} a^K(v_h,v_h) &\text{ (stability)}\\
&= \alpha^- a(v_h,v_h) &\text{ (equation \ref{aKvsa})}\\
&= \alpha^- \|v_h\|_{H_0^1(\Omega)}^2. &\text{ (equation \ref{acoercive})}
\end{align*}
\end{itemize}
Consequently, by Lax-Milgram theorem, the discrete problem (\ref{discretepb}) admits one unique solution $u_h$.
\item Let $u_I\in V_h$ and $u_\pi$ piecewise in $\mathbb{P}_k$ such that they are approximations of the exact solution $u$ of problem (\ref{weak}). Let $\delta_h = u_h-u_I\in V_h$. Then, 
\begin{align*}
\alpha^-\|\delta_h\|^2_{H_0^1(\Omega)}
&\leq a_h(\delta_h,\delta_h) \text{ (coercivity of }a_h)\\
&= a_h(u_h,\delta_h) - a_h(u_I,\delta_h) \\
& \text{    }(a_h \text{ linear and definition of }\delta_h)\\
&= \langle f_h, \delta_h\rangle - \sum_{K\in T_h}a_h^K(u_I,\delta_h) \\
& \text{    (problem (\ref{discretepb}) and hypothesis }1.b)\\
&= \langle f_h, \delta_h\rangle - \sum_{K\in T_h}\left( a_h^K\left( u_I-u_\pi, \delta_h \right) + a_h^K\left( u_\pi,\delta_h\right) \right)\\
&\text{    } (a_h \text{ linear and }\pm u_\pi)
\end{align*}
\end{enumerate}
\end{proof}

\begin{remark}
\begin{itemize} A few remarks on the theorem:
\item The integer $k\geq 1$ will be the order of accuracy. \textbf{TODO tell more??}
\item The stability property (hypothesis $2.c$) is crucial to show the existence and uniqueness of the solution since without it, we cannot show that $a_h$ has the required properties to apply Lax-Milgram theorem.
\end{itemize}
\end{remark}